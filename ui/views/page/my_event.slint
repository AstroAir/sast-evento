import { Token } from "../../global.slint";
import { ScrollView } from "std-widgets.slint";
import { Page, Empty } from "../../components/index.slint";
import { STimeLine, STimeLineItem } from "../../modules/surrealism-ui/src/timeline/index.slint";
import { SCard } from "../../modules/surrealism-ui/src/card/index.slint";
import {SLink} from "../../modules/surrealism-ui/src/link/index.slint";
import { SDivider } from "../../modules/surrealism-ui/src/divider/index.slint";
import { SText } from "../../modules/surrealism-ui/src/text/index.slint";
import { STab } from "../../modules/surrealism-ui/src/tab/index.slint";
import { Icon } from "../../modules/surrealism-ui/src/icon/icon.slint";
import {SButton} from "../../modules/surrealism-ui/src/button/index.slint";
export global MyEventPageBridge { }

// button
export component SignButton inherits SButton{
    width: 40px;
    height: 20px;
    background: Token.color.surface;
    border-color: Token.color.outline;
    font-color: Token.color.on-surface;
    text: "签到";
    property <bool> active : true;
    clicked => {active = !active}
    states [
        active when  !active : {
            text : "取消";
        }
        inactive when active: {
            text : "签到";
        } 
    ]
}

// a simple event form
export component EventForm {
    Rectangle {
        preferred-height: 200px;
        preferred-width: 500px;
        mes := Rectangle{
            x: (parent.x)+5px;
            preferred-height: 200px;
            preferred-width: 50px;
            VerticalLayout {
                alignment: center;
                data := SText {
                    color: Token.color.outline;
                    text: "日期";
                }
                place := SText{
                    color: Token.color.outline;
                    text: "地点";
                }
                time := SText{
                    color: Token.color.outline;
                    text: "时间";
                }
            }
        }
        form := STimeLine{
            x: mes.x + 80px;
            width: 20px;
            height: parent.height;
            STimeLineItem {
                width: (parent.width)+100px;
                height: parent.height;
                SCard {
                    x: (parent.x)-10px;
                    y: -30px;
                    height: parent.height;
                    width: 380px;
                    background: Token.color.surface-container-lowest;
                    Icon {
                        x: parent.x+30px;
                        height: 50px;
                        width: 50px;
                        source: Token.image.icon.evento;
                    }
                    info := Rectangle{
                        x: parent.x+80px;
                        preferred-height: 200px;
                        preferred-width: 200px;
                        VerticalLayout {
                            alignment: center;
                            title := SText {
                                font-size: Token.font.headline.small.size;
                                color: Token.color.outline;
                                text: "标题";
                            }
                            introduce := SText{
                                font-size: Token.font.label.small.size;
                                color: Token.color.outline;
                                text: "介绍";
                            }
                            content := SText{
                                font-size: Token.font.label.small.size;
                                color: Token.color.outline;
                                text: "内容";
                            }
                        }
                    }
                    SignButton {
                        x: parent.x+320px;
                    }
                }
            }
        }
    }
}

// a simple component for schedule
export component Schedule {
    preferred-height: 800px;
    preferred-width: 600px;
    in-out property <string> title : "";
    VerticalLayout {
        spacing: 5px;
        //title
        SText {
            x: (parent.width)/2-(parent.x)-50px;
            color: Token.color.on-surface;
            font-size: Token.font.title.large.size;
            //text: "进行中";
            text: title;
        }
        //SDvider
        SDivider {
            //y: parent.y+40px;
            width: 500px;
            height: 2px;
            }
        //SText && STimeLine (separate)
        @children
    }
}

export component MyEventPage inherits Page {
    // TODO: implement MyEvent
    // optional
    ScrollView {
        background := Empty { }

        body := Empty {
            x: 0;
            y: 0px;
            width: 100%;
            height: 100%;
            //schedule timeline
            HorizontalLayout {
                signin-line := Schedule {
                    width: 50%;
                    height: 100%;
                    title: "已报名";
                    EventForm {}
                    EventForm {}
                    EventForm {}
                }
                VerticalLayout {
                    spacing: 150px;
                    start-line := Schedule { 
                        width: 50%;
                        title: "进行中";
                        // height: 50%;
                        EventForm { }
                    }
                    end-line := Schedule { 
                        width: 50%;
                        // height: 50%;
                        title: "已结束";
                        EventForm { }
                    }
                }
            }
            
            placeholder := Rectangle {
                border-width: 4px;
                border-color: red;
                // Text {
                //     text: "活动日程（我的活动）\n  未开始、进行中、已结束";
                // }
            }
        }
    }
}

